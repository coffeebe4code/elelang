const std = @import("std");
const ascii = @import("std").ascii;
const testing = std.testing;

export const TokenE = enum(u8) {
    Import,
    Define,
    Macro,
    Test,
    Bench,
    Mut,
    Let,
    Const,
    Once,
    Num,
    I32,
    U32,
    U64,
    I64,
    I16,
    U16,
    U8,
    I8,
    Bit,
    F64,
    F32,
    D32,
    D64,
    If,
    Else,
    Type,
    This,
    Null,
    Char,
    WString,
    Inline,
    Static,
    Switch,
    For,
    In,
    Break,
    Enum,
    Pub,
    Return,
    Async,
    Await,
    WBox,
    Trait,
    Ptr,
    Match,
    Addr,
    Vol,
    True,
    False,
    Void,
    Iface,
    Gen,
    Undef,
    Never,
    Bool,
    Byte,
    Fn,
    Contract,
    Queue,
    Thread,
    Pool,
    Observe,
    Message,
    Suspend,
    Resume,
    Block,
    OParen,
    CParen,
    OBrace,
    CBrace,
    OArray,
    CArray,
    Dot,
    Comma,
    Dollar,
    Question,
    Pound,
    Colon,
    SColon,
    Backtick,
    At,
    Lt,
    LtEq,
    Gt,
    GtEq,
    Div,
    BSlash,
    Plus,
    Rest,
    Sub,
    Mul,
    Or,
    And,
    Xor,
    LShift,
    RShift,
    Not,
    As,
    NotAs,
    OrAs,
    AndAs,
    XorAs,
    LShiftAs,
    RShiftAs,
    AndLog,
    OrLog,
    NotEquality,
    Equality,
    NotLog,
    Mod,
    Inc,
    Dec,
    AddAs,
    SubAs,
    DivAs,
    MulAs,
    ModAs,
    DQuote,
    SQuote,
    Symbol,
    Hex,
    Bin,
    Num,
    Decimal,
    NewLine,
    Wsp,
    Empty,
    Range,
};

threadlocal var ibuffer: []const u8 = undefined;
threadlocal var iter = undefined;

pub fn init(buffer: *[]const u8) @This() {
    ibuffer = buffer;
}

pub fn get_next() anyerror!?TokenE {
    var c: u8 = ibuffer;
    if (ascii.isAlphabetic(c)) {} else if (ascii.isAlphanumeric(c)) {} else {
        return switch (c) {
            ' ' => {
                skip_whitespace();
                return .Wsp;
            },
        };
    }
}

inline fn tokenize_symbol() void {
    //    iter++;
    //    while (++ibuffer.* != std) {
    //
    //    }
}

inline fn skip_whitespace() void {
    //    iter++;
    //    while (++ibuffer.* != std) {
    //
    //    }
}

const keywords = [_]u8{
    "import",
    "define",
    "macro",
    "test",
    "bench",
    "mut",
    "let",
    "const",
    "once",
    "num",
    "i32",
    "u32",
    "u64",
    "i64",
    "i16",
    "u16",
    "u8",
    "i8",
    "bit",
    "f64",
    "f32",
    "d32",
    "d64",
    "if",
    "else",
    "type",
    "this",
    "null",
    "char",
    "string",
    "inline",
    "static",
    "switch",
    "for",
    "in",
    "break",
    "enum",
    "pub",
    "return",
    "async",
    "await",
    "box",
    "trait",
    "ptr",
    "match",
    "addr",
    "vol",
    "true",
    "false",
    "void",
    "iface",
    "gen",
    "undef",
    "never",
    "bool",
    "byte",
    "fn",
    "contract",
    "queue",
    "thread",
    "pool",
    "observe",
    "message",
    "block",
    "suspend",
    "resume",
};

test "basic tokenization" {}
